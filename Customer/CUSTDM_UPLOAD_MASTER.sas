%MACRO CUSTMERGEINTO(INSTANCE);
PROC SQL;
CONNECT TO ORACLE (USER=&USER. PW=&PASSWORD. PATH="&PATH.");
	EXECUTE (MERGE INTO BIOR.O_CUSTOMER_ALL BIOR
    USING SKYNET.CUSTOMER_DATAMART_&INSTANCE. UPSERT
        ON (BIOR.CUSTNBR=UPSERT.CUSTNBR 
		    AND BIOR.INSTANCE=UPSERT.INSTANCE)
        WHEN MATCHED THEN UPDATE
           SET 
                BIOR.POS=UPSERT.POS,
/*                BIOR.INSTANCE=UPSERT.INSTANCE,*/
				BIOR.CHANNELCD = UPSERT.CHANNELCD,
                BIOR.BRANDCD=UPSERT.BRANDCD,
                BIOR.COUNTRYCD=UPSERT.COUNTRYCD,
                BIOR.STATE=UPSERT.STATE,
                BIOR.CITY=UPSERT.CITY,
                BIOR.ZIP=UPSERT.ZIP,
                BIOR.ZONENBR=UPSERT.ZONENBR,
                BIOR.ZONENAME=UPSERT.ZONENAME,
                BIOR.REGIONNBR=UPSERT.REGIONNBR,
                BIOR.REGIONRDO=UPSERT.REGIONRDO,
                BIOR.DIVISIONNBR=UPSERT.DIVISIONNBR,
                BIOR.DIVISIONDDO=UPSERT.DIVISIONDDO,
                BIOR.LOCNBR=UPSERT.LOCNBR,
                BIOR.LOCATION_NAME=UPSERT.LOCATION_NAME,
                BIOR.LOC_OPEN_DT=UPSERT.LOC_OPEN_DT,
				BIOR.LOC_CLOSE_DT=UPSERT.LOC_CLOSE_DT,
                BIOR.APPLICATIONDT=UPSERT.APPLICATIONDT,
                BIOR.LAST_REPORT_DT=UPSERT.LAST_REPORT_DT,
                BIOR.LATITUDE=UPSERT.LATITUDE,
                BIOR.LONGITUDE=UPSERT.LONGITUDE,
/*                BIOR.CUSTNBR=UPSERT.CUSTNBR,*/
				BIOR.OMNINBR=UPSERT.OMNINBR,
/*                BIOR.SSN=UPSERT.SSN,*/
                BIOR.BUSINESSUNITCD=UPSERT.BUSINESSUNITCD,
                BIOR.STND_CUSTOMER_STATUS=UPSERT.STND_CUSTOMER_STATUS,
				BIOR.FIRSTNM=UPSERT.FIRSTNM,
                BIOR.LASTNM=UPSERT.LASTNM,
                BIOR.MIDDLENM=UPSERT.MIDDLENM,
                BIOR.DRIVERSLICST=UPSERT.DRIVERSLICST,
				BIOR.DRIVERSLICNBR=UPSERT.DRIVERSLICNBR,
                BIOR.DOB=UPSERT.DOB,
                BIOR.ADDRESS_LN1=UPSERT.ADDRESS_LN1,
                BIOR.ADDRESS_LN2=UPSERT.ADDRESS_LN2,
                BIOR.ADDRESS_CITY=UPSERT.ADDRESS_CITY,
                BIOR.ADDRESS_STATE=UPSERT.ADDRESS_STATE,
                BIOR.ADDRESS_ZIP=UPSERT.ADDRESS_ZIP,
                BIOR.ADDRESS_COUNTRY=UPSERT.ADDRESS_COUNTRY,
				BIOR.HOME_PHONENBR=UPSERT.HOME_PHONENBR,
                BIOR.MOBILE_PHONENBR=UPSERT.MOBILE_PHONENBR,
                BIOR.WORK_PHONENBR=UPSERT.WORK_PHONENBR,
                BIOR.OTHER_PHONENBR=UPSERT.OTHER_PHONENBR,
                BIOR.OTHER_PHONECD=UPSERT.OTHER_PHONECD,
                BIOR.EMAILADDRESS=UPSERT.EMAILADDRESS,
                BIOR.BANK_ABANBR=UPSERT.BANK_ABANBR,
                BIOR.BANK_ACCOUNTNBR=UPSERT.BANK_ACCOUNTNBR,
				BIOR.GMI=UPSERT.GMI,
				BIOR.DATASHARECD=UPSERT.DATASHARECD,
                BIOR.DO_NOT_MAIL=UPSERT.DO_NOT_MAIL,
                BIOR.LANGUAGECD=UPSERT.LANGUAGECD,
                BIOR.UPDATEDT=UPSERT.UPDATEDT,
                BIOR.MARKETING_SOURCE=UPSERT.MARKETING_SOURCE,
                BIOR.MARKETING_SOURCE_DATE=UPSERT.MARKETING_SOURCE_DATE
         WHEN NOT MATCHED
            THEN INSERT
                 (POS, 
		          INSTANCE,
				  CHANNELCD,
		          BRANDCD, 
		          COUNTRYCD, 
		          STATE, 
		          CITY, 
		          ZIP, 
		          ZONENBR, 
		          ZONENAME, 
		          REGIONNBR, 
		          REGIONRDO, 
		          DIVISIONNBR, 
		          DIVISIONDDO, 
		          LOCNBR, 
		          LOCATION_NAME, 
		          LOC_OPEN_DT, 
		          LOC_CLOSE_DT, 
		          APPLICATIONDT, 
		          LAST_REPORT_DT, 
		          LATITUDE, 
		          LONGITUDE, 
		          CUSTNBR,
				  OMNINBR, 
		          SSN, 
		          BUSINESSUNITCD, 
		          STND_CUSTOMER_STATUS, 
		          FIRSTNM, 
		          LASTNM, 
		          MIDDLENM, 
		          DRIVERSLICST, 
		          DRIVERSLICNBR, 
		          DOB, 
		          ADDRESS_LN1, 
		          ADDRESS_LN2, 
		          ADDRESS_CITY, 
		          ADDRESS_STATE, 
		          ADDRESS_ZIP, 
		          ADDRESS_COUNTRY, 
		          HOME_PHONENBR, 
		          MOBILE_PHONENBR, 
		          WORK_PHONENBR, 
		          OTHER_PHONENBR, 
		          OTHER_PHONECD, 
		          EMAILADDRESS, 
		          BANK_ABANBR, 
		          BANK_ACCOUNTNBR, 
		          GMI, 
		          DATASHARECD, 
		          DO_NOT_MAIL, 
		          LANGUAGECD, 
		          UPDATEDT, 
		          MARKETING_SOURCE, 
		          MARKETING_SOURCE_DATE)
            VALUES 
                 (UPSERT.POS, 
		          UPSERT.INSTANCE,
				  UPSERT.CHANNELCD, 
		          UPSERT.BRANDCD, 
		          UPSERT.COUNTRYCD, 
		          UPSERT.STATE, 
		          UPSERT.CITY, 
		          UPSERT.ZIP, 
		          UPSERT.ZONENBR, 
		          UPSERT.ZONENAME, 
		          UPSERT.REGIONNBR, 
		          UPSERT.REGIONRDO, 
		          UPSERT.DIVISIONNBR, 
		          UPSERT.DIVISIONDDO, 
		          UPSERT.LOCNBR, 
		          UPSERT.LOCATION_NAME, 
		          UPSERT.LOC_OPEN_DT, 
		          UPSERT.LOC_CLOSE_DT, 
		          UPSERT.APPLICATIONDT, 
		          UPSERT.LAST_REPORT_DT, 
		          UPSERT.LATITUDE, 
		          UPSERT.LONGITUDE, 
		          UPSERT.CUSTNBR,
				  UPSERT.OMNINBR, 
		          UPSERT.SSN, 
		          UPSERT.BUSINESSUNITCD, 
		          UPSERT.STND_CUSTOMER_STATUS, 
		          UPSERT.FIRSTNM, 
		          UPSERT.LASTNM, 
		          UPSERT.MIDDLENM, 
		          UPSERT.DRIVERSLICST, 
		          UPSERT.DRIVERSLICNBR, 
		          UPSERT.DOB, 
		          UPSERT.ADDRESS_LN1, 
		          UPSERT.ADDRESS_LN2, 
		          UPSERT.ADDRESS_CITY, 
		          UPSERT.ADDRESS_STATE, 
		          UPSERT.ADDRESS_ZIP, 
		          UPSERT.ADDRESS_COUNTRY, 
		          UPSERT.HOME_PHONENBR, 
		          UPSERT.MOBILE_PHONENBR, 
		          UPSERT.WORK_PHONENBR, 
		          UPSERT.OTHER_PHONENBR, 
		          UPSERT.OTHER_PHONECD, 
		          UPSERT.EMAILADDRESS, 
		          UPSERT.BANK_ABANBR, 
		          UPSERT.BANK_ACCOUNTNBR, 
		          UPSERT.GMI, 
		          UPSERT.DATASHARECD, 
		          UPSERT.DO_NOT_MAIL, 
		          UPSERT.LANGUAGECD, 
		          UPSERT.UPDATEDT, 
		          UPSERT.MARKETING_SOURCE, 
		          UPSERT.MARKETING_SOURCE_DATE)
	) BY ORACLE;
	DISCONNECT FROM ORACLE;
QUIT;
%MEND;