%INCLUDE "\\CSSSASAPP\CADA\SAS SOURCE CODE\PRODUCTION\SERVICE ACCOUNTS\SVC_SASUSER.SAS";
%INCLUDE "E:\SHARED\CADA\SAS SOURCE CODE\DEVELOPMENT\JHUBBARD\TOP SECRET PROGRAM.SAS";
%INCLUDE "E:\SHARED\CADA\SAS SOURCE CODE\DEVELOPMENT\JHUBBARD\SKYNET REDESIGN\DATAMART REDESIGN\DAILY\DAILY_ERROR_INPUTS.SAS";

LIBNAME TMP_TBLS ORACLE
	USER=&USER.
	PASSWORD=&PASSWORD.
	PATH=BIOR
	SCHEMA=TEMPTABLES;

DATA _NULL_;
	/*CUSTOMER*/
	CALL SYMPUTX('CUST_LOGPATH',"E:\SHARED\CADA\LOGS\SKYNET V2",'G');
	CALL SYMPUTX('CUST_FILE_PATH',"E:\SHARED\CADA\SAS SOURCE CODE\PRODUCTION\SKYNET V2\SKYNET REDESIGN\DATAMART REDESIGN\CUSTOMER",'G');
	/*DEAL*/
	CALL SYMPUTX('DEAL_LOGPATH',"E:\SHARED\CADA\LOGS\SKYNET V2",'G');
	CALL SYMPUTX('DEAL_FILE_PATH',"E:\SHARED\CADA\SAS SOURCE CODE\PRODUCTION\SKYNET V2\SKYNET REDESIGN\DATAMART REDESIGN\DEAL",'G');
	/*TRAN*/
	CALL SYMPUTX('TRAN_LOGPATH',"E:\SHARED\CADA\LOGS\SKYNET V2",'G');
	CALL SYMPUTX('TRAN_FILE_PATH',"E:\SHARED\CADA\SAS SOURCE CODE\PRODUCTION\SKYNET V2\SKYNET REDESIGN\DATAMART REDESIGN\TRANSACTION",'G');
	/*DAILY*/
	CALL SYMPUTX('DAILY_LOGPATH',"E:\SHARED\CADA\LOGS\SKYNET V2",'G');
	CALL SYMPUTX('DAILY_FILE_PATH',"E:\SHARED\CADA\SAS SOURCE CODE\PRODUCTION\SKYNET V2\SKYNET REDESIGN\DATAMART REDESIGN\DAILY",'G');
	/*SKYNET RESIGN LOGS*/
	CALL SYMPUTX('SKYNETREDESIGN',"E:\SHARED\CADA\SAS SOURCE CODE\PRODUCTION\SKYNET V2\SKYNET REDESIGN",'G');
	CALL SYMPUTX('SKYNETREDESIGN_LOGS',"E:\SHARED\CADA\LOGS\SKYNET V2",'G');
RUN;



/*  UPDATE BIOR PRODUCTION TABLE WITH NEW DATA */
/*  UPDATE BIOR PRODUCTION TABLE WITH NEW DATA  */
PROC SQL;
	CONNECT TO ORACLE (USER=&USER. PASSWORD=&PASSWORD. PATH="BIOR") ;
	EXECUTE (MERGE INTO BIOR.O_DAILY_SUMMARY_ALL BIOR
    USING SKYNET.DAILYSUM_CUST_NUM UPSERT
        ON (BIOR.INSTANCE=UPSERT.INSTANCE 
		    AND BIOR.PRODUCT_DESC=UPSERT.PRODUCT_DESC 
			AND BIOR.LOCNBR=UPSERT.LOCNBR
			AND BIOR.BUSINESSDT = UPSERT.BUSINESSDT
			AND BIOR.PRODUCT = UPSERT.PRODUCT)
        WHEN MATCHED THEN UPDATE
           SET 
/*                BIOR.PRODUCT=UPSERT.PRODUCT,*/
/*                BIOR.PRODUCT_DESC=UPSERT.PRODUCT_DESC,*/
                BIOR.POS=UPSERT.POS,
/*                BIOR.INSTANCE=UPSERT.INSTANCE,*/
                BIOR.BRANDCD=UPSERT.BRANDCD,
                BIOR.BANKMODEL=UPSERT.BANKMODEL,
                BIOR.COUNTRYCD=UPSERT.COUNTRYCD,
                BIOR.STATE=UPSERT.STATE,
                BIOR.CITY=UPSERT.CITY,
                BIOR.ZIP=UPSERT.ZIP,
                BIOR.BUSINESS_UNIT=UPSERT.BUSINESS_UNIT,
                BIOR.ZONENBR=UPSERT.ZONENBR,
                BIOR.ZONENAME=UPSERT.ZONENAME,
                BIOR.REGIONNBR=UPSERT.REGIONNBR,
                BIOR.REGIONRDO=UPSERT.REGIONRDO,
                BIOR.DIVISIONNBR=UPSERT.DIVISIONNBR,
				BIOR.DIVISIONDDO=UPSERT.DIVISIONDDO,
/*                BIOR.LOCNBR=UPSERT.LOCNBR,*/
                BIOR.LOCATION_NAME=UPSERT.LOCATION_NAME,
                BIOR.LOC_OPEN_DT=UPSERT.LOC_OPEN_DT,
                BIOR.LOC_CLOSE_DT=UPSERT.LOC_CLOSE_DT,
/*                BIOR.BUSINESSDT=UPSERT.BUSINESSDT,*/
                BIOR.LAST_REPORT_DT=UPSERT.LAST_REPORT_DT,
                BIOR.LOC_LAST_REPORTED_DT=UPSERT.LOC_LAST_REPORTED_DT,
                BIOR.LATITUDE=UPSERT.LATITUDE,
				BIOR.LONGITUDE=UPSERT.LONGITUDE,
                BIOR.HOLIDAYNAME=UPSERT.HOLIDAYNAME,
                BIOR.LASTTHURSDAY=UPSERT.LASTTHURSDAY,
                BIOR.THURSDAYWEEK=UPSERT.THURSDAYWEEK,
				BIOR.NEW_ADV_AMT=UPSERT.NEW_ADV_AMT,
                BIOR.NEW_ORIGINATIONS=UPSERT.NEW_ORIGINATIONS,
                BIOR.NEW_ADVFEE_AMT=UPSERT.NEW_ADVFEE_AMT,
                BIOR.TOTADVRECV=UPSERT.TOTADVRECV,
                BIOR.TOTADVFEERECV=UPSERT.TOTADVFEERECV,
                BIOR.DEFAULT_LOANS_OUTSTANDING=UPSERT.DEFAULT_LOANS_OUTSTANDING,
                BIOR.COMPLIANT_LOANS_OUTSTANDING=UPSERT.COMPLIANT_LOANS_OUTSTANDING,
                BIOR.TOTDEFAULTRECV=UPSERT.TOTDEFAULTRECV,
				BIOR.TOTDEFAULTFEERECV=UPSERT.TOTDEFAULTFEERECV,
                BIOR.NSF_AMOUNT=UPSERT.NSF_AMOUNT,
                BIOR.NSF_PAYMENT_AMOUNT=UPSERT.NSF_PAYMENT_AMOUNT,
                BIOR.NSF_PREPAYMENT_AMOUNT=UPSERT.NSF_PREPAYMENT_AMOUNT,
                BIOR.WOAMTSUM=UPSERT.WOAMTSUM,
                BIOR.WOCNT=UPSERT.WOCNT,
                BIOR.WOBAMTSUM=UPSERT.WOBAMTSUM,
                BIOR.WOBCNT=UPSERT.WOBCNT,
				BIOR.WORAMTSUM=UPSERT.WORAMTSUM,
				BIOR.WORCNT=UPSERT.WORCNT,
                BIOR.CASHAGAIN_COUNT=UPSERT.CASHAGAIN_COUNT,
                BIOR.BUYBACK_COUNT=UPSERT.BUYBACK_COUNT,
                BIOR.DEPOSIT_COUNT=UPSERT.DEPOSIT_COUNT,
                BIOR.GROSS_REVENUE=UPSERT.GROSS_REVENUE,
                BIOR.GROSS_WRITE_OFF=UPSERT.GROSS_WRITE_OFF,
                BIOR.NET_WRITE_OFF=UPSERT.NET_WRITE_OFF,
                BIOR.NET_REVENUE=UPSERT.NET_REVENUE,
                BIOR.BEGIN_PWO_AMT=UPSERT.BEGIN_PWO_AMT,
				BIOR.CURRENT_PWO_AMT=UPSERT.CURRENT_PWO_AMT,
				BIOR.NEXT_MONTH_PWO_AMT=UPSERT.NEXT_MONTH_PWO_AMT,
                BIOR.NEXT_2_MONTH_PWO_AMT=UPSERT.NEXT_2_MONTH_PWO_AMT,
                BIOR.RCC_IN_PROCESS=UPSERT.RCC_IN_PROCESS,
                BIOR.RCC_INELIGIBLE=UPSERT.RCC_INELIGIBLE,
                BIOR.DEL_RECV_AMT=UPSERT.DEL_RECV_AMT,
                BIOR.DEL_RECV_CNT=UPSERT.DEL_RECV_CNT,
                BIOR.DEFAULT_PMT=UPSERT.DEFAULT_PMT,
                BIOR.DEFAULT_CNT=UPSERT.DEFAULT_CNT,
                BIOR.DEFAULT_AMT=UPSERT.DEFAULT_AMT,
                BIOR.NEWCUSTCNTCOMPANY=UPSERT.NEWCUSTCNTCOMPANY,
                BIOR.REDEEM_CUSTOMER_CNT=UPSERT.REDEEM_CUSTOMER_CNT,
                BIOR.REACTIVE_CUSTOMER_CNT=UPSERT.REACTIVE_CUSTOMER_CNT,
                BIOR.ACTIVE_CUST_CNT=UPSERT.ACTIVE_CUST_CNT,
                BIOR.INACTIVE_CUST_CNT=UPSERT.INACTIVE_CUST_CNT,
				BIOR.ACTUAL_DURATION_COUNT=UPSERT.ACTUAL_DURATION_COUNT,
				BIOR.ACTUAL_DURATION_DAYS=UPSERT.ACTUAL_DURATION_DAYS,
                BIOR.ACTUAL_DURATION_ADVAMT=UPSERT.ACTUAL_DURATION_ADVAMT,
                BIOR.ACTUAL_DURATION_FEES=UPSERT.ACTUAL_DURATION_FEES,
                BIOR.AVGDURATIONDAYS=UPSERT.AVGDURATIONDAYS,
                BIOR.AVGDURATIONCNT=UPSERT.AVGDURATIONCNT,
                BIOR.BLACK_BOOK_VALUE=UPSERT.BLACK_BOOK_VALUE,
				BIOR.PASTDUECNT_1=UPSERT.PASTDUECNT_1,
				BIOR.PASTDUEAMT_1=UPSERT.PASTDUEAMT_1,
                BIOR.PASTDUECNT_2=UPSERT.PASTDUECNT_2,
                BIOR.PASTDUEAMT_2=UPSERT.PASTDUEAMT_2,
                BIOR.PASTDUECNT_3=UPSERT.PASTDUECNT_3,
                BIOR.PASTDUEAMT_3=UPSERT.PASTDUEAMT_3,
                BIOR.PASTDUECNT_4=UPSERT.PASTDUECNT_4,
				BIOR.PASTDUEAMT_4=UPSERT.PASTDUEAMT_4,
				BIOR.PASTDUECNT_5=UPSERT.PASTDUECNT_5,
                BIOR.PASTDUEAMT_5=UPSERT.PASTDUEAMT_5,
                BIOR.PASTDUECNT_6=UPSERT.PASTDUECNT_6,
                BIOR.PASTDUEAMT_6=UPSERT.PASTDUEAMT_6,
                BIOR.REFINANCE_CNT=UPSERT.REFINANCE_CNT,
                BIOR.OVERSHORTAMT=UPSERT.OVERSHORTAMT,
                BIOR.HOLDOVERAMT=UPSERT.HOLDOVERAMT,
                BIOR.FIRST_PRESENTMENT_CNT=UPSERT.FIRST_PRESENTMENT_CNT,
                BIOR.SATISFIED_PAYMENT_CNT=UPSERT.SATISFIED_PAYMENT_CNT,
                BIOR.POSSESSION_AMT=UPSERT.POSSESSION_AMT,
                BIOR.POSSESSION_CNT=UPSERT.POSSESSION_CNT,
                BIOR.SOLD_AMOUNT=UPSERT.SOLD_AMOUNT,
                BIOR.SOLD_COUNT=UPSERT.SOLD_COUNT,
                BIOR.ADVCNT=UPSERT.ADVCNT,
                BIOR.REPMTPLANCNT=UPSERT.REPMTPLANCNT,
                BIOR.AVGADVAMT=UPSERT.AVGADVAMT,
                BIOR.AVGDURATION=UPSERT.AVGDURATION,
                BIOR.AVGFEEAMT=UPSERT.AVGFEEAMT,
                BIOR.ADVAMTSUM=UPSERT.ADVAMTSUM,
                BIOR.HELDCNT=UPSERT.HELDCNT,
                BIOR.AGNCNT=UPSERT.AGNCNT,
				BIOR.CHANNELCD=UPSERT.CHANNELCD
         WHEN NOT MATCHED
            THEN INSERT
                 (PRODUCT, 
		          PRODUCT_DESC, 
		          POS, 
		          INSTANCE, 
		          BRANDCD, 
		          BANKMODEL, 
		          COUNTRYCD, 
		          STATE, 
		          CITY, 
		          ZIP, 
		          BUSINESS_UNIT, 
		          ZONENBR, 
		          ZONENAME, 
		          REGIONNBR, 
		          REGIONRDO, 
		          DIVISIONNBR, 
		          DIVISIONDDO, 
		          LOCNBR, 
		          LOCATION_NAME, 
		          LOC_OPEN_DT, 
		          LOC_CLOSE_DT, 
		          BUSINESSDT, 
		          LAST_REPORT_DT, 
		          LOC_LAST_REPORTED_DT, 
		          LATITUDE, 
		          LONGITUDE, 
		          HOLIDAYNAME, 
		          LASTTHURSDAY, 
		          THURSDAYWEEK, 
		          NEW_ADV_AMT, 
		          NEW_ORIGINATIONS, 
		          NEW_ADVFEE_AMT, 
		          TOTADVRECV, 
		          TOTADVFEERECV, 
		          DEFAULT_LOANS_OUTSTANDING, 
		          COMPLIANT_LOANS_OUTSTANDING, 
		          TOTDEFAULTRECV, 
		          TOTDEFAULTFEERECV, 
		          NSF_AMOUNT, 
		          NSF_PAYMENT_AMOUNT, 
		          NSF_PREPAYMENT_AMOUNT, 
		          WOAMTSUM, 
		          WOCNT, 
		          WOBAMTSUM, 
		          WOBCNT, 
		          WORAMTSUM, 
		          WORCNT, 
		          CASHAGAIN_COUNT, 
		          BUYBACK_COUNT, 
		          DEPOSIT_COUNT, 
		          GROSS_REVENUE, 
		          GROSS_WRITE_OFF, 
		          NET_WRITE_OFF, 
		          NET_REVENUE, 
		          BEGIN_PWO_AMT, 
		          CURRENT_PWO_AMT, 
		          NEXT_MONTH_PWO_AMT, 
		          NEXT_2_MONTH_PWO_AMT, 
		          RCC_IN_PROCESS, 
		          RCC_INELIGIBLE, 
		          DEL_RECV_AMT, 
		          DEL_RECV_CNT, 
		          DEFAULT_PMT, 
		          DEFAULT_CNT, 
		          DEFAULT_AMT, 
		          NEWCUSTCNTCOMPANY, 
		          REDEEM_CUSTOMER_CNT, 
		          REACTIVE_CUSTOMER_CNT, 
		          ACTIVE_CUST_CNT, 
		          INACTIVE_CUST_CNT, 
		          ACTUAL_DURATION_COUNT, 
		          ACTUAL_DURATION_DAYS, 
		          ACTUAL_DURATION_ADVAMT, 
		          ACTUAL_DURATION_FEES, 
		          AVGDURATIONDAYS, 
		          AVGDURATIONCNT, 
		          BLACK_BOOK_VALUE, 
		          PASTDUECNT_1, 
		          PASTDUEAMT_1, 
		          PASTDUEAMT_2, 
		          PASTDUECNT_2, 
		          PASTDUEAMT_3, 
		          PASTDUECNT_3, 
		          PASTDUEAMT_4, 
		          PASTDUECNT_4, 
		          PASTDUEAMT_5, 
		          PASTDUECNT_5, 
		          PASTDUEAMT_6, 
		          PASTDUECNT_6, 
		          REFINANCE_CNT, 
		          OVERSHORTAMT, 
		          HOLDOVERAMT, 
		          FIRST_PRESENTMENT_CNT, 
		          SATISFIED_PAYMENT_CNT, 
		          POSSESSION_AMT, 
		          POSSESSION_CNT, 
		          SOLD_AMOUNT, 
		          SOLD_COUNT, 
		          ADVCNT, 
		          REPMTPLANCNT, 
		          AVGADVAMT, 
		          AVGDURATION, 
		          AVGFEEAMT, 
		          ADVAMTSUM, 
		          HELDCNT, 
		          AGNCNT,
				  CHANNELCD)
            VALUES 
                 (UPSERT.PRODUCT, 
		          UPSERT.PRODUCT_DESC, 
		          UPSERT.POS, 
		          UPSERT.INSTANCE, 
		          UPSERT.BRANDCD, 
		          UPSERT.BANKMODEL, 
		          UPSERT.COUNTRYCD, 
		          UPSERT.STATE, 
		          UPSERT.CITY, 
		          UPSERT.ZIP, 
		          UPSERT.BUSINESS_UNIT, 
		          UPSERT.ZONENBR, 
		          UPSERT.ZONENAME, 
		          UPSERT.REGIONNBR, 
		          UPSERT.REGIONRDO, 
		          UPSERT.DIVISIONNBR, 
		          UPSERT.DIVISIONDDO, 
		          UPSERT.LOCNBR, 
		          UPSERT.LOCATION_NAME, 
		          UPSERT.LOC_OPEN_DT, 
		          UPSERT.LOC_CLOSE_DT, 
		          UPSERT.BUSINESSDT, 
		          UPSERT.LAST_REPORT_DT, 
		          UPSERT.LOC_LAST_REPORTED_DT, 
		          UPSERT.LATITUDE, 
		          UPSERT.LONGITUDE, 
		          UPSERT.HOLIDAYNAME, 
		          UPSERT.LASTTHURSDAY, 
		          UPSERT.THURSDAYWEEK, 
		          UPSERT.NEW_ADV_AMT, 
		          UPSERT.NEW_ORIGINATIONS, 
		          UPSERT.NEW_ADVFEE_AMT, 
		          UPSERT.TOTADVRECV, 
		          UPSERT.TOTADVFEERECV, 
		          UPSERT.DEFAULT_LOANS_OUTSTANDING, 
		          UPSERT.COMPLIANT_LOANS_OUTSTANDING, 
		          UPSERT.TOTDEFAULTRECV, 
		          UPSERT.TOTDEFAULTFEERECV, 
		          UPSERT.NSF_AMOUNT, 
		          UPSERT.NSF_PAYMENT_AMOUNT, 
		          UPSERT.NSF_PREPAYMENT_AMOUNT, 
		          UPSERT.WOAMTSUM, 
		          UPSERT.WOCNT, 
		          UPSERT.WOBAMTSUM, 
		          UPSERT.WOBCNT, 
		          UPSERT.WORAMTSUM, 
		          UPSERT.WORCNT, 
		          UPSERT.CASHAGAIN_COUNT, 
		          UPSERT.BUYBACK_COUNT, 
		          UPSERT.DEPOSIT_COUNT, 
		          UPSERT.GROSS_REVENUE, 
		          UPSERT.GROSS_WRITE_OFF, 
		          UPSERT.NET_WRITE_OFF, 
		          UPSERT.NET_REVENUE, 
		          UPSERT.BEGIN_PWO_AMT, 
		          UPSERT.CURRENT_PWO_AMT, 
		          UPSERT.NEXT_MONTH_PWO_AMT, 
		          UPSERT.NEXT_2_MONTH_PWO_AMT, 
		          UPSERT.RCC_IN_PROCESS, 
		          UPSERT.RCC_INELIGIBLE, 
		          UPSERT.DEL_RECV_AMT, 
		          UPSERT.DEL_RECV_CNT, 
		          UPSERT.DEFAULT_PMT, 
		          UPSERT.DEFAULT_CNT, 
		          UPSERT.DEFAULT_AMT, 
		          UPSERT.NEWCUSTCNTCOMPANY, 
		          UPSERT.REDEEM_CUSTOMER_CNT, 
		          UPSERT.REACTIVE_CUSTOMER_CNT, 
		          UPSERT.ACTIVE_CUST_CNT, 
		          UPSERT.INACTIVE_CUST_CNT, 
		          UPSERT.ACTUAL_DURATION_COUNT, 
		          UPSERT.ACTUAL_DURATION_DAYS, 
		          UPSERT.ACTUAL_DURATION_ADVAMT, 
		          UPSERT.ACTUAL_DURATION_FEES, 
		          UPSERT.AVGDURATIONDAYS, 
		          UPSERT.AVGDURATIONCNT, 
		          UPSERT.BLACK_BOOK_VALUE, 
		          UPSERT.PASTDUECNT_1, 
		          UPSERT.PASTDUEAMT_1, 
		          UPSERT.PASTDUEAMT_2, 
		          UPSERT.PASTDUECNT_2, 
		          UPSERT.PASTDUEAMT_3, 
		          UPSERT.PASTDUECNT_3, 
		          UPSERT.PASTDUEAMT_4, 
		          UPSERT.PASTDUECNT_4, 
		          UPSERT.PASTDUEAMT_5, 
		          UPSERT.PASTDUECNT_5, 
		          UPSERT.PASTDUEAMT_6, 
		          UPSERT.PASTDUECNT_6, 
		          UPSERT.REFINANCE_CNT, 
		          UPSERT.OVERSHORTAMT, 
		          UPSERT.HOLDOVERAMT, 
		          UPSERT.FIRST_PRESENTMENT_CNT, 
		          UPSERT.SATISFIED_PAYMENT_CNT, 
		          UPSERT.POSSESSION_AMT, 
		          UPSERT.POSSESSION_CNT, 
		          UPSERT.SOLD_AMOUNT, 
		          UPSERT.SOLD_COUNT, 
		          UPSERT.ADVCNT, 
		          UPSERT.REPMTPLANCNT, 
		          UPSERT.AVGADVAMT, 
		          UPSERT.AVGDURATION, 
		          UPSERT.AVGFEEAMT, 
		          UPSERT.ADVAMTSUM, 
		          UPSERT.HELDCNT, 
		          UPSERT.AGNCNT,
				  UPSERT.CHANNELCD)
	) BY ORACLE;
	DISCONNECT FROM ORACLE;
QUIT;